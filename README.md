
# Suricata SIEM.js Dashboard

A Security Information and Event Management (SIEM) solution leveraging Suricata for network intrusion detection and real-time monitoring. This project includes a web interface to view, group, and manage alerts generated by Suricata, making it easier for security teams to respond to potential threats.

## Table of Contents

- [Features](#features)
- [Getting Started](#getting-started)
- [Configuration](#configuration)
- [Usage](#usage)
- [Future Improvements](#future-improvements)

## Features

- **Network Intrusion Detection:** Detects and logs network-based attacks and anomalies using Suricata.
- **Web Dashboard:** Interactive web interface for browsing, filtering, and managing alerts.
- **Alert Grouping:** Groups alerts based on configurable criteria to reduce alert fatigue.
- **Pagination and Filtering:** Enables easy navigation of alerts by time frame, severity, protocol, and more.
- **Status Management:** Allows escalation and acknowledgment of alerts.

## Getting Started

### Prerequisites

- **Docker:** Ensure Docker is installed on your machine or server.
- **Docker Compose:** Install Docker Compose for container orchestration.
- **Supported Platforms:** 
  - For ARM (e.g., Raspberry Pi): `jasonish/suricata:6.0.15-arm32v6` or `jasonish/suricata:6.0.15-arm64v8`
  - For x86_64 (e.g., AWS EC2): `jasonish/suricata:6.0.15`

### Installation

1. **Clone the repository:**
   ```bash
   git clone https://github.com/imperror/SIEM.js.git
   cd SIEM.js
   ```

2. **Set Up Suricata Configuration:**
   - Edit `suricata.yaml` as needed in the `config/` folder to define network interfaces, rule files, and logging preferences.
   - Key settings to review in `suricata.yaml`:
     - **Network Interface**: Ensure the correct network interface is specified.
     - **Payload Logging**: Adjust `payload` settings for alert packet data (`payload: yes`).
     - **Rules Path**: Specify any custom rules or paths for threat detection.

3. **Configure Environment Variables (Optional):**
   - Set environment variables in `.env` (optional), such as network ports, database credentials, or other configuration preferences.

### Running the Application

1. **Start the Application:**
   ```bash
   docker-compose up -d
   ```
   This will start the Suricata instance and the SIEM web dashboard. Suricata will log events to `eve.json`, and the web app will parse this data for display.

2. **Access the Web Interface:**
   Open a browser and go to `http://localhost:3000` (or the serverâ€™s IP address).

### Stopping the Application

To stop the application and remove containers, use:
```bash
docker-compose down
```

## Configuration

### Suricata Configuration

The main configuration file for Suricata is `config/suricata.yaml`. Key sections include:

- **Interface**: Set your network interface (e.g., `eth0`) under `af-packet`.
- **Payload Logging**: Enable `payload: yes` to include packet data in alerts.
- **Rules**: Customize or add rule files in the `rules/` directory.

### Application Configuration

Edit the `docker-compose.yml` file for environment-specific settings such as port mappings and volume mounts.

## Usage

### Viewing and Managing Alerts

- **Tabs**:
  - **Inbox**: View new alerts.
  - **Escalated**: Manage alerts marked as escalated.
  - **Alerts**: See all alerts with filtering options.
  - **Stats**: View aggregated statistics of alerts.
  - **Events**: View specific events from Suricata (e.g., HTTP, DNS).

- **Filtering**: Use the search and time-frame filters to locate specific alerts.
- **Status Management**: Escalate or acknowledge alerts from the dashboard.
- **Alert Details**: Click on an alert to view detailed packet data, grouped by similar events.

## Future Improvements

### Authentication and User Management

Add user authentication to restrict access to authorized personnel. Integrate role-based access control (RBAC) for different permissions:
- **Admin**: Full access to manage users and alerts.
- **Analyst**: Can view, filter, and manage alerts.
- **Viewer**: Read-only access to alerts and events.

### Telegram Integration

Set up Telegram integration to receive real-time alerts. This can help in staying updated on critical alerts directly from mobile devices:
1. **Telegram Bot**: Create a Telegram bot and use the bot API to send alerts.
2. **Customizable Triggers**: Define alert thresholds (e.g., severity level) that should trigger a Telegram notification.

### Email Notifications

Integrate email alerts for critical notifications:
- **SMTP Server**: Configure an SMTP server or use services like SendGrid for sending emails.
- **Notification Rules**: Allow users to set rules (e.g., specific IPs, protocols, or severity) that trigger email alerts.

### Reporting and Analytics

Generate downloadable reports of daily, weekly, or monthly activities, with insights such as:
- **Top Alert Sources**: Track the IPs or regions causing the most alerts.
- **Protocol Distribution**: Analyze which protocols (e.g., HTTP, DNS, TCP) are triggering alerts.

### Improved Packet Data Decoding and Visualization

- **Original vs Decoded Views**: Allow users to toggle between original and decoded packet data for easier analysis.
- **Detailed Packet Analysis**: Integrate packet analysis for protocols like HTTP and DNS for enriched data in the alert details.

### Log Rotation and Archiving

Implement log rotation for long-term storage and archival of Suricata logs to prevent excessive disk usage.

### Docker and Kubernetes Compatibility

Optimize for container orchestration:
- **Kubernetes**: Add deployment scripts for Kubernetes, with pod scaling for high-traffic networks.
- **Logging Aggregation**: Integrate with systems like Elasticsearch and Kibana for scalable log management.

## Troubleshooting

- **Network Interface Not Found**: Ensure the correct network interface is set in `suricata.yaml` and that Docker has permission to access it.
- **Database Connection Issues**: Verify database credentials in Docker Compose and ensure the database container is running.
- **Exec Format Error**: If running on ARM, use the ARM-compatible image (`jasonish/suricata:6.0.15-arm32v6`).

## Contributing

Feel free to submit issues or feature requests. Contributions to the project are welcome!
